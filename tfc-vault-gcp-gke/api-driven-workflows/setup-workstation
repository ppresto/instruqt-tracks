#!/bin/bash -l
set -e

mkdir /root/terraform/json
cd /root/terraform/json
set-workdir /root/terraform/json

# Create some payload files for the student
for VAR in placeholder width height; do
cat <<-EOF > /root/terraform/json/var-${VAR}.json
{
  "data": {
    "type":"vars",
    "attributes": {
      "key":"${VAR}",
      "value":"REPLACE_ME",
      "category":"terraform",
      "hcl":false,
      "sensitive":false
    },
    "relationships": {
      "workspace": {
        "data": {
          "id":"REPLACE_WITH_WORKSPACE_ID",
          "type":"workspaces"
        }
      }
    }
  }
}
EOF
done

# Create the payload for the plan/apply
cat <<-EOF > /root/terraform/json/apply.json
{
  "data": {
    "attributes": {
      "is-destroy":false,
      "message": "Terraform Cloud API is Magic! ü¶Ñ üåà üßô‚Äç‚ôÇÔ∏è"
    },
    "type":"runs",
    "relationships": {
      "workspace": {
        "data": {
          "type": "workspaces",
          "id": "REPLACE_WITH_WORKSPACE_ID"
        }
      }
    }
  }
}
EOF

exit 0
